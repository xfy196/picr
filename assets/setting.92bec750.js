import{A as Z,f as v,g as z,h as x,v as J,o as c,c as f,w as t,V as K,a as l,B as R,b as m,i as M,F as L,j as U,e as r,t as p,W as Y,X as Q,Y as ee,G as te,Z as ae,a0 as le,a1 as oe,a2 as ne,a3 as se,a4 as ue,a5 as re,a6 as ie,a7 as de}from"./vendor.4554e321.js";/* empty css              */import{u as S,a as ce,b as pe}from"./index.3c48fa7e.js";/* empty css              *//* empty css               */import{_ as _e,u as ve}from"./index.b316be68.js";const fe=r("\u786E\u8BA4Token"),me={key:0},ge=r("\u624B\u52A8\u521B\u5EFA\u4E00\u4E2A\u76EE\u5F55"),he=r("\u5B58\u653E\u5728\u6839\u76EE\u5F55"),ye=r("\u6839\u636E\u65E5\u671F\u81EA\u52A8\u521B\u5EFAYYYYMMDD\u683C\u5F0F"),De=r("\u91CD\u7F6E"),ke=r("\u5B8C\u6210\u914D\u7F6E"),Re={setup(Me){const s=ve(),{config:u,repos:T,branches:q}=Z(s),B=v([]),y=v(!1),D=v(null),F=z(),$=v({selectedRepo:[{required:!0,message:"\u8BF7\u9009\u62E9\u6587\u4EF6\u4E0A\u4F20\u7684\u4ED3\u5E93",trigger:"blur"}],selectedBranch:[{required:!0,message:"\u8BF7\u9009\u62E9\u4ED3\u5E93\u7684\u5206\u652F",trigger:"blur"}],selectedDir:[{required:!0,message:"\u8BF7\u8F93\u5165\u4E0A\u4F20\u6587\u4EF6\u7684\u76EE\u5F55",trigger:"blur",type:"string"}],selectedDirList:[{required:!0,message:"\u8BF7\u9009\u62E9\u4E0A\u4F20\u6587\u4EF6\u7684\u76EE\u5F55",trigger:"blur",type:"array"}]}),e=v({token:u.value.token,login:u.value.login,dirMode:u.value.dirMode,selectedDir:u.value.selectedDir,selectedRepo:u.value.selectedRepo,selectedBranch:u.value.selectedBranch,selectedDirList:u.value.selectedDirList}),_=v({1:"\u65B0\u5EFA\u76EE\u5F55",2:"\u6839\u76EE\u5F55",3:"\u81EA\u52A8\u76EE\u5F55",4:`\u9009\u62E9${u.value.selectedRepo}\u4ED3\u5E93\u76EE\u5F55`}),H=S(async()=>{y.value=!0,await s.getUser(e.value.token),e.value.token=u.value.token,e.value.login=u.value.login,await s.getRepos(),y.value=!1},1e3,!1),N=S(async n=>{n.target.scrollHeight-n.target.scrollTop-n.target.clientHeight<50&&s.repoHasMore&&(s.setRepoPage(s.repoPage+1),await s.getRepos())}),P=async()=>{try{await D.value.validate(),s.updateConfig({dirMode:e.value.dirMode,selectedDir:e.value.selectedDir,selectedRepo:e.value.selectedRepo,selectedBranch:e.value.selectedBranch,selectedDirList:e.value.selectedDirList}),F.push({path:"/upload"})}catch(n){console.log(n)}},V=()=>{D.value.resetFields(),s.logout()},j=()=>{e.value.dirMode===2?e.value.selectedDir="/":e.value.dirMode===3?e.value.selectedDir=ce(pe(),"YYYY/MM/DD").value:e.value.dirMode===1?e.value.selectedDir="xxx":e.value.dirMode===4&&(e.value.selectedDirList=[])},I=async n=>{const a=n[n.length-1];a.loading=!0;let d=await s.getBranchCatalogue({repo:e.value.selectedRepo,dir:e.value.selectedDirList.join("/"),query:{ref:e.value.selectedBranch}});a.loading=!1;let i=b(d);if(i.length===0){a.isLeaf=!0;return}a.children=i},b=n=>n.filter(a=>a.type==="dir").map(a=>{let d={};return d.label=a.name,d.value=a.name,d.isLeaf=!1,d});return x(()=>e.value.selectedBranch,async n=>{if(e.value.selectedDirList=[],n.trim()){let a=await s.getBranchCatalogue({repo:e.value.selectedRepo,dir:"",query:{ref:n}});B.value=b(a)}},{immediate:!0}),x(()=>e.value.selectedRepo,async n=>{n.trim()&&(u.value.selectedRepo!==n&&(e.value.selectedBranch=""),await s.getBranches(n))},{immediate:!0}),J(async()=>{u.value.id&&await s.getRepos()}),(n,a)=>{const d=Q,i=ee,k=te,w=de,C=ae,g=le,h=oe,A=ne,E=se,G=ue,O=re,W=ie,X=K;return c(),f(X,{class:"container"},{default:t(()=>[l(W,{ref_key:"formRef",ref:D,model:e.value,"label-col":{span:5},"wrapper-col":{span:16},rules:$.value,autocomplete:"off"},{default:t(()=>[l(i,{label:"Token",name:"token"},{default:t(()=>[l(d,{value:e.value.token,"onUpdate:value":a[0]||(a[0]=o=>e.value.token=o)},null,8,["value"])]),_:1}),l(i,{"wrapper-col":{offset:5,span:16}},{default:t(()=>[l(k,{onClick:R(m(H),["stop"]),type:"primary"},{default:t(()=>[fe]),_:1},8,["onClick"])]),_:1}),l(O,{style:{width:"100%",", min-height":"100px"},spinning:y.value,tip:"Loading..."},{default:t(()=>[m(u).id?(c(),M("div",me,[l(i,{label:"\u7528\u6237\u540D",name:"login"},{default:t(()=>[l(d,{readonly:"",value:e.value.login,"onUpdate:value":a[1]||(a[1]=o=>e.value.login=o)},null,8,["value"])]),_:1}),l(i,{name:"selectedRepo",label:"\u9009\u62E9\u56FE\u5E8A\u4ED3\u5E93"},{default:t(()=>[l(C,{onPopupScroll:m(N),"show-search":"",value:e.value.selectedRepo,"onUpdate:value":a[2]||(a[2]=o=>e.value.selectedRepo=o)},{default:t(()=>[(c(!0),M(L,null,U(m(T),o=>(c(),f(w,{key:o.id,value:o.name},{default:t(()=>[r(p(o.name),1)]),_:2},1032,["value"]))),128))]),_:1},8,["onPopupScroll","value"])]),_:1}),l(i,{name:"selectedBranch",label:"\u9009\u62E9\u4ED3\u5E93\u5206\u652F"},{default:t(()=>[l(C,{"show-search":"",value:e.value.selectedBranch,"onUpdate:value":a[3]||(a[3]=o=>e.value.selectedBranch=o)},{default:t(()=>[(c(!0),M(L,null,U(m(q),o=>(c(),f(w,{key:o.name,value:o.name},{default:t(()=>[r(p(o.name),1)]),_:2},1032,["value"]))),128))]),_:1},8,["value"])]),_:1}),e.value.selectedBranch?(c(),f(i,{key:0,name:"dirMode",label:"\u76EE\u5F55\u65B9\u5F0F"},{default:t(()=>[l(A,{onChange:j,value:e.value.dirMode,"onUpdate:value":a[4]||(a[4]=o=>e.value.dirMode=o)},{default:t(()=>[l(h,null,{title:t(()=>[ge]),default:t(()=>[l(g,{value:1},{default:t(()=>[r(p(_.value[1]),1)]),_:1})]),_:1}),l(h,null,{title:t(()=>[he]),default:t(()=>[l(g,{value:2},{default:t(()=>[r(p(_.value[2]),1)]),_:1})]),_:1}),l(h,null,{title:t(()=>[ye]),default:t(()=>[l(g,{value:3},{default:t(()=>[r(p(_.value[3]),1)]),_:1})]),_:1}),l(h,null,{title:t(()=>[r("\u9009\u62E9"+p(e.value.selectedBranch)+"\u5206\u652F\u4E0B\u7684\u4E00\u4E2A\u76EE\u5F55",1)]),default:t(()=>[l(g,{value:4},{default:t(()=>[r(p(_.value[4]),1)]),_:1})]),_:1})]),_:1},8,["value"])]),_:1})):Y("",!0),e.value.selectedBranch&&e.value.dirMode!==4?(c(),f(i,{key:1,name:"selectedDir",label:_.value[e.value.dirMode]},{default:t(()=>[l(d,{readonly:e.value.dirMode!==1,value:e.value.selectedDir,"onUpdate:value":a[5]||(a[5]=o=>e.value.selectedDir=o)},null,8,["readonly","value"])]),_:1},8,["label"])):(c(),f(i,{key:2,name:"selectedDirList",label:_.value[e.value.dirMode]},{default:t(()=>[l(E,{"change-on-select":"",options:B.value,"load-data":I,value:e.value.selectedDirList,"onUpdate:value":a[6]||(a[6]=o=>e.value.selectedDirList=o),placeholder:"\u8BF7\u9009\u62E9\u76EE\u5F55"},null,8,["options","value"])]),_:1},8,["label"])),l(i,{"wrapper-col":{offset:5,span:16}},{default:t(()=>[l(G,null,{default:t(()=>[l(k,{onClick:R(V,["stop"])},{default:t(()=>[De]),_:1},8,["onClick"]),l(k,{onClick:R(P,["stop"]),type:"primary"},{default:t(()=>[ke]),_:1},8,["onClick"])]),_:1})]),_:1})])):Y("",!0)]),_:1},8,["spinning"])]),_:1},8,["model","rules"])]),_:1})}}};var Ue=_e(Re,[["__scopeId","data-v-9c804684"]]);export{Ue as default};
